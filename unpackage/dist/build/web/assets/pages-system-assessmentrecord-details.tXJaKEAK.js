import{_ as e,e as t,N as a,q as l,O as s,an as c,H as d,c as i,w as r,i as u,o as n,h as o,k as f,t as _,A as m,l as v,m as g,F as p,v as h,p as k,j as b}from"./index-1tsbwzWw.js";const y=t.database();const S=e({data:()=>({details:null,metricResults:null}),onLoad(e){e.id&&this.getDetails(e.id)},methods:{formatTime(e){if(!e)return"-";const t=new Date(e);if(isNaN(t.getTime()))return"-";return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`},formatDuration(e){if(!e&&0!==e)return"-";const t=Math.floor(e/60),a=Math.floor(e%60);return t>0?`${t}小时${a>0?a+"分钟":""}`:`${a}分钟`},getScoreClass:e=>e||0===e?e>=90?"score-excellent":e>=80?"score-good":e>=60?"score-fair":"score-poor":"",async getDetails(e){try{a({mask:!0});const t=await y.collection("AssessmentRecord").doc(e).get();if(t.result.data&&t.result.data.length>0&&(this.details=t.result.data[0],this.details.recordId)){const e=await y.collection("MetricResult").where({recordId:this.details.recordId}).get();e.result.data&&e.result.data.length>0&&(this.metricResults=e.result.data[0])}}catch(t){console.error("获取详情失败:",t),l({title:"获取详情失败",icon:"error"})}finally{s()}},copyUrl(e){c({data:e,success:()=>{l({title:"复制成功",icon:"success"})}})},goBack(){this.getOpenerEventChannel().emit("refreshData"),d()}}},[["render",function(e,t,a,l,s,c){const d=h,y=k,S=u;return n(),i(S,{class:"detail-container"},{default:r((()=>[o(S,{class:"detail-card"},{default:r((()=>[o(S,{class:"card-header"},{default:r((()=>[o(d,{class:"header-title"},{default:r((()=>[f("测评详情")])),_:1}),o(y,{onClick:c.goBack,class:"uni-button",type:"default",size:"mini"},{default:r((()=>[f("返回")])),_:1},8,["onClick"])])),_:1}),o(S,{class:"basic-info"},{default:r((()=>[o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("主播姓名：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.name)||"-"),1)]})),_:1})])),_:1}),o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("记录ID：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.recordId)||"-"),1)]})),_:1})])),_:1}),o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("用户ID：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.userId)||"-"),1)]})),_:1})])),_:1}),o(S,{class:"info-item"},{default:r((()=>{var e;return[o(d,{class:"label"},{default:r((()=>[f("得分：")])),_:1}),o(d,{class:m(["score-value",c.getScoreClass(null==(e=s.details)?void 0:e.score)])},{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.score)||"-"),1)]})),_:1},8,["class"])]})),_:1}),o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("测评时间：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_(c.formatTime(null==(e=s.details)?void 0:e.assessmentTime)||"-"),1)]})),_:1})])),_:1}),o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("持续时间：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_(c.formatDuration(null==(e=s.details)?void 0:e.duration)||"-"),1)]})),_:1})])),_:1})])),_:1}),o(S,{class:"metrics-detail"},{default:r((()=>[o(S,{class:"section-title"},{default:r((()=>[f("资源信息")])),_:1}),o(S,{class:"metric-card"},{default:r((()=>[o(S,{class:"metric-content"},{default:r((()=>[o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("文件ID：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.fileId)||"-"),1)]})),_:1})])),_:1}),o(S,{class:"info-item"},{default:r((()=>[o(d,{class:"label"},{default:r((()=>[f("Token数：")])),_:1}),o(d,null,{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.totaltoken)||0),1)]})),_:1})])),_:1}),o(S,{class:"info-item"},{default:r((()=>{var e;return[o(d,{class:"label"},{default:r((()=>[f("文件链接：")])),_:1}),(null==(e=s.details)?void 0:e.uploadUrl)?(n(),i(S,{key:0,class:"link-group"},{default:r((()=>[o(d,{class:"link-text"},{default:r((()=>[f(_(s.details.uploadUrl),1)])),_:1}),o(y,{class:"uni-button",type:"primary",size:"mini",onClick:t[0]||(t[0]=e=>c.copyUrl(s.details.uploadUrl))},{default:r((()=>[f("复制")])),_:1})])),_:1})):(n(),i(d,{key:1},{default:r((()=>[f("-")])),_:1}))]})),_:1})])),_:1})])),_:1})])),_:1}),o(S,{class:"metrics-detail"},{default:r((()=>{var e,t;return[o(S,{class:"section-title"},{default:r((()=>[f("指标评测结果")])),_:1}),(null==(t=null==(e=s.metricResults)?void 0:e.metrics)?void 0:t.length)?(n(),i(S,{key:0,class:"metric-card"},{default:r((()=>[o(S,{class:"metric-content"},{default:r((()=>[(n(!0),v(p,null,g(s.metricResults.metrics,((e,t)=>(n(),i(S,{key:t,class:"metric-result-item"},{default:r((()=>[o(S,{class:"metric-header"},{default:r((()=>[o(d,{class:"metric-name"},{default:r((()=>[f(_(e.metricname),1)])),_:2},1024),o(d,{class:m(["metric-score",c.getScoreClass(e.score)])},{default:r((()=>[f(_(e.score)+"分",1)])),_:2},1032,["class"])])),_:2},1024),o(S,{class:"metric-details"},{default:r((()=>[o(S,{class:"metric-detail-item"},{default:r((()=>[o(d,{class:"detail-label"},{default:r((()=>[f("评估等级：")])),_:1}),o(d,{class:"detail-value"},{default:r((()=>[f(_(e.description.level),1)])),_:2},1024)])),_:2},1024),o(S,{class:"metric-detail-item"},{default:r((()=>[o(d,{class:"detail-label"},{default:r((()=>[f("评估结论：")])),_:1}),o(d,{class:"detail-value"},{default:r((()=>[f(_(e.description.evaluation),1)])),_:2},1024)])),_:2},1024),o(S,{class:"metric-detail-item"},{default:r((()=>[o(d,{class:"detail-label"},{default:r((()=>[f("改进建议：")])),_:1}),o(d,{class:"detail-value"},{default:r((()=>[f(_(e.description.suggestion),1)])),_:2},1024)])),_:2},1024),e.token?(n(),i(S,{key:0,class:"metric-detail-item"},{default:r((()=>[o(d,{class:"detail-label"},{default:r((()=>[f("Token消耗：")])),_:1}),o(d,{class:"detail-value"},{default:r((()=>[f(_(e.token),1)])),_:2},1024)])),_:2},1024)):b("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):(n(),i(S,{key:1,class:"metric-card"},{default:r((()=>[o(S,{class:"metric-content"},{default:r((()=>[o(d,{class:"empty-text"},{default:r((()=>[f("暂无评测结果")])),_:1})])),_:1})])),_:1}))]})),_:1}),o(S,{class:"metrics-detail"},{default:r((()=>[o(S,{class:"section-title"},{default:r((()=>[f("报告")])),_:1}),o(S,{class:"metric-card"},{default:r((()=>[o(S,{class:"metric-content"},{default:r((()=>[o(S,{class:"content-section"},{default:r((()=>[o(S,{class:"report-content"},{default:r((()=>[o(d,{class:"report-text","user-select":""},{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.record)||"暂无文本内容"),1)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),o(S,{class:"metrics-detail"},{default:r((()=>[o(S,{class:"section-title"},{default:r((()=>[f("视频内容")])),_:1}),o(S,{class:"metric-card"},{default:r((()=>[o(S,{class:"metric-content"},{default:r((()=>[o(S,{class:"content-section"},{default:r((()=>[o(S,{class:"report-content"},{default:r((()=>[o(d,{class:"report-text","user-select":""},{default:r((()=>{var e;return[f(_((null==(e=s.details)?void 0:e.text)||"暂无记录内容"),1)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-51623045"]]);export{S as default};
