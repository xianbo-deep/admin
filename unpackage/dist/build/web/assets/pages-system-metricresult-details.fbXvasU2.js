import{_ as e,e as t,q as a,H as l,c as s,w as i,i as r,o as d,h as n,k as c,t as o,l as u,m as f,F as _,v,p as m,A as g,j as h}from"./index-BQ2OFzYe.js";const p=t.database();const S=e({data:()=>({detail:null}),computed:{formattedTime(){var e;return this.formatTime(null==(e=this.detail)?void 0:e.evaluationTime)},averageScore(){var e,t;if(!(null==(t=null==(e=this.detail)?void 0:e.metrics)?void 0:t.length))return"-";return(this.detail.metrics.reduce(((e,t)=>e+(t.score||0)),0)/this.detail.metrics.length).toFixed(2)},totalTokens(){var e,t;if(!(null==(t=null==(e=this.detail)?void 0:e.metrics)?void 0:t.length))return"-";return this.detail.metrics.reduce(((e,t)=>e+(t.token||0)),0).toFixed(0)}},onLoad(e){e.id&&this.loadDetail(e.id)},methods:{formatTime(e){if(!e)return"-";const t=new Date(e);if(isNaN(t.getTime()))return"-";return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`},async loadDetail(e){try{const t=await p.collection("MetricResult").doc(e).get();t.result.data&&t.result.data.length>0&&(this.detail=t.result.data[0])}catch(t){console.error("获取详情失败:",t),a({title:"获取详情失败",icon:"error"})}},getScoreClass:e=>e||0===e?e>=90?"score-excellent":e>=80?"score-good":e>=60?"score-fair":"score-poor":"",getLevelClass(e){if(!e)return"";return{A:"level-excellent",B:"level-good",C:"level-fair",D:"level-poor"}[e]||""},goBack(){l()}}},[["render",function(e,t,a,l,p,S){const b=v,k=m,x=r;return d(),s(x,{class:"detail-container"},{default:i((()=>[n(x,{class:"detail-card"},{default:i((()=>[n(x,{class:"card-header"},{default:i((()=>[n(b,{class:"header-title"},{default:i((()=>[c("评估详情")])),_:1}),n(k,{onClick:S.goBack,class:"uni-button",type:"default",size:"mini"},{default:i((()=>[c("返回")])),_:1},8,["onClick"])])),_:1}),n(x,{class:"basic-info"},{default:i((()=>[n(x,{class:"info-item"},{default:i((()=>[n(b,{class:"label"},{default:i((()=>[c("评估ID：")])),_:1}),n(b,null,{default:i((()=>{var e;return[c(o((null==(e=p.detail)?void 0:e.resultId)||"-"),1)]})),_:1})])),_:1}),n(x,{class:"info-item"},{default:i((()=>[n(b,{class:"label"},{default:i((()=>[c("记录ID：")])),_:1}),n(b,null,{default:i((()=>{var e;return[c(o((null==(e=p.detail)?void 0:e.recordId)||"-"),1)]})),_:1})])),_:1}),n(x,{class:"info-item"},{default:i((()=>[n(b,{class:"label"},{default:i((()=>[c("评估时间：")])),_:1}),n(b,null,{default:i((()=>[c(o(S.formattedTime||"-"),1)])),_:1})])),_:1}),n(x,{class:"info-item"},{default:i((()=>[n(b,{class:"label"},{default:i((()=>[c("平均得分：")])),_:1}),n(b,null,{default:i((()=>[c(o(S.averageScore),1)])),_:1})])),_:1}),n(x,{class:"info-item"},{default:i((()=>[n(b,{class:"label"},{default:i((()=>[c("总Token：")])),_:1}),n(b,null,{default:i((()=>[c(o(S.totalTokens),1)])),_:1})])),_:1})])),_:1}),n(x,{class:"metrics-detail"},{default:i((()=>{var e;return[n(x,{class:"section-title"},{default:i((()=>[c("指标详情")])),_:1}),(d(!0),u(_,null,f(null==(e=p.detail)?void 0:e.metrics,(e=>(d(),s(x,{key:e.metricId,class:"metric-card"},{default:i((()=>[n(x,{class:"metric-header"},{default:i((()=>[n(x,{class:"metric-title"},{default:i((()=>[n(b,{class:"metric-name"},{default:i((()=>[c(o(e.metricname||"未命名指标"),1)])),_:2},1024),n(x,{class:"metric-stats"},{default:i((()=>[n(x,{class:"stat-item"},{default:i((()=>[n(b,{class:"stat-label"},{default:i((()=>[c("得分：")])),_:1}),n(b,{class:g(["stat-value",S.getScoreClass(e.score)])},{default:i((()=>{var t;return[c(o((null==(t=e.score)?void 0:t.toFixed(2))||"-"),1)]})),_:2},1032,["class"])])),_:2},1024),n(x,{class:"stat-item"},{default:i((()=>[n(b,{class:"stat-label"},{default:i((()=>[c("Token：")])),_:1}),n(b,{class:"stat-value"},{default:i((()=>{var t;return[c(o((null==(t=e.token)?void 0:t.toFixed(0))||"-"),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(x,{class:"metric-content"},{default:i((()=>{var t,a;return[n(x,{class:"content-section"},{default:i((()=>[n(b,{class:"section-subtitle"},{default:i((()=>[c("评估等级")])),_:1}),n(x,{class:"level-content"},{default:i((()=>{var t;return[n(b,{class:g(["level-badge",S.getLevelClass(null==(t=e.description)?void 0:t.level)])},{default:i((()=>{var t;return[c(o((null==(t=e.description)?void 0:t.level)||"未评级"),1)]})),_:2},1032,["class"])]})),_:2},1024)])),_:2},1024),(null==(t=e.description)?void 0:t.evaluation)?(d(),s(x,{key:0,class:"content-section"},{default:i((()=>[n(b,{class:"section-subtitle"},{default:i((()=>[c("评估结论")])),_:1}),n(x,{class:"evaluation-content"},{default:i((()=>[n(b,{class:"evaluation-text"},{default:i((()=>[c(o(e.description.evaluation),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):h("",!0),(null==(a=e.description)?void 0:a.suggestion)?(d(),s(x,{key:1,class:"content-section"},{default:i((()=>[n(b,{class:"section-subtitle"},{default:i((()=>[c("改进建议")])),_:1}),n(x,{class:"suggestion-content"},{default:i((()=>[n(b,{class:"suggestion-text"},{default:i((()=>[c(o(e.description.suggestion),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):h("",!0)]})),_:2},1024)])),_:2},1024)))),128))]})),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-2cf1af44"]]);export{S as default};
