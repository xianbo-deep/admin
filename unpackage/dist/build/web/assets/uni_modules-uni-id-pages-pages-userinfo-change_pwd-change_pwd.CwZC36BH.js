import{_ as s,e as o,x as a,y as e,z as r,s as t,r as d,a as l,c as n,w as u,i,o as w,h as m,k as f,u as c,v as p,p as P}from"./index-BQ2OFzYe.js";import{_ as h}from"./uni-match-media.b36FJk4-.js";import{_}from"./uni-easyinput.VVN8Z8n5.js";import{_ as g}from"./uni-forms-item.O5OP8sj5.js";import{_ as y}from"./uni-forms.CeWDBJu8.js";import{m as b}from"./login-page.mixin.DCLFJwoI.js";import{p as x}from"./password.CUT7RN6Y.js";const D=o.importObject("uni-id-co",{customUI:!0});const V=s({mixins:[b],data:()=>({focusOldPassword:!1,focusNewPassword:!1,focusNewPassword2:!1,formData:{oldPassword:"",newPassword:"",newPassword2:""},rules:{oldPassword:{rules:[{required:!0,errorMessage:"请输入新密码"},{pattern:/^.{6,20}$/,errorMessage:"密码为6 - 20位"}]},...x.getPwdRules("newPassword","newPassword2")},logo:"/static/logo.png"}),onReady(){this.$refs.form.setRules(this.rules)},onShow(){document.onkeydown=s=>{let o=s||window.event;o&&13==o.keyCode&&this.submit()}},methods:{submit(){this.$refs.form.validate().then((s=>{let{oldPassword:o,newPassword:d}=this.formData;D.updatePwd({oldPassword:o,newPassword:d}).then((s=>{a("uni_id_token"),e("uni_id_token_expired",0),r({url:"/uni_modules/uni-id-pages/pages/login/login-withpwd"})})).catch((s=>{t({content:s.message,showCancel:!1})}))})).catch((s=>{let o=s[0].key;o=o.replace(o[0],o[0].toUpperCase()),this["focus"+o]=!0}))}}},[["render",function(s,o,a,e,r,t){const b=c,x=i,D=p,V=d(l("uni-match-media"),h),j=d(l("uni-easyinput"),_),k=d(l("uni-forms-item"),g),v=P,B=d(l("uni-forms"),y);return w(),n(x,{class:"uni-content"},{default:u((()=>[m(V,{"min-width":690},{default:u((()=>[m(x,{class:"login-logo"},{default:u((()=>[m(b,{src:r.logo},null,8,["src"])])),_:1}),m(D,{class:"title title-box"},{default:u((()=>[f("修改密码")])),_:1})])),_:1}),m(B,{ref:"form",value:r.formData,"err-show-type":"toast"},{default:u((()=>[m(k,{name:"oldPassword"},{default:u((()=>[m(j,{focus:r.focusOldPassword,onBlur:o[0]||(o[0]=s=>r.focusOldPassword=!1),class:"input-box",type:"password",inputBorder:!1,modelValue:r.formData.oldPassword,"onUpdate:modelValue":o[1]||(o[1]=s=>r.formData.oldPassword=s),placeholder:"请输入旧密码"},null,8,["focus","modelValue"])])),_:1}),m(k,{name:"newPassword"},{default:u((()=>[m(j,{focus:r.focusNewPassword,onBlur:o[2]||(o[2]=s=>r.focusNewPassword=!1),class:"input-box",type:"password",inputBorder:!1,modelValue:r.formData.newPassword,"onUpdate:modelValue":o[3]||(o[3]=s=>r.formData.newPassword=s),placeholder:"请输入新密码"},null,8,["focus","modelValue"])])),_:1}),m(k,{name:"newPassword2"},{default:u((()=>[m(j,{focus:r.focusNewPassword2,onBlur:o[4]||(o[4]=s=>r.focusNewPassword2=!1),class:"input-box",type:"password",inputBorder:!1,modelValue:r.formData.newPassword2,"onUpdate:modelValue":o[5]||(o[5]=s=>r.formData.newPassword2=s),placeholder:"请再次输入新密码"},null,8,["focus","modelValue"])])),_:1}),m(v,{class:"uni-btn send-btn-box",type:"primary",onClick:t.submit},{default:u((()=>[f("提交")])),_:1},8,["onClick"])])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-4d5da121"]]);export{V as default};
